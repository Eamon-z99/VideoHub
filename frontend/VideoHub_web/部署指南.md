# VideoHub å‰ç«¯éƒ¨ç½²æŒ‡å—

## ğŸ“‹ ç›®å½•

1. [ç¯å¢ƒå‡†å¤‡](#ç¯å¢ƒå‡†å¤‡)
2. [æ„å»ºé¡¹ç›®](#æ„å»ºé¡¹ç›®)
3. [éƒ¨ç½²æ–¹å¼](#éƒ¨ç½²æ–¹å¼)
4. [Nginxé…ç½®](#nginxé…ç½®)
5. [ç¯å¢ƒå˜é‡é…ç½®](#ç¯å¢ƒå˜é‡é…ç½®)
6. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸ› ï¸ ç¯å¢ƒå‡†å¤‡

### 1. å®‰è£… Node.js

ç¡®ä¿å·²å®‰è£… Node.js >= 16.0.0ï¼š

```bash
node -v
npm -v
```

### 2. å®‰è£…ä¾èµ–

```bash
cd frontend/VideoHub_web
npm install
```

---

## ğŸ—ï¸ æ„å»ºé¡¹ç›®

### 1. é…ç½®ç¯å¢ƒå˜é‡

æ ¹æ®éƒ¨ç½²ç¯å¢ƒï¼Œé…ç½®ç›¸åº”çš„ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼š

**ç”Ÿäº§ç¯å¢ƒ** (`.env.production`):
```env
VITE_API_BASE_URL=https://api.yourdomain.com
```

**å¼€å‘ç¯å¢ƒ** (`.env.development`):
```env
# ä½¿ç”¨Viteä»£ç†ï¼Œä¸éœ€è¦è®¾ç½®
# æˆ–ç›´æ¥è¿æ¥åç«¯
VITE_API_BASE_URL=http://localhost:8888
```

### 2. æ‰§è¡Œæ„å»º

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build
```

æ„å»ºå®Œæˆåï¼Œä¼šåœ¨ `dist` ç›®å½•ç”Ÿæˆé™æ€æ–‡ä»¶ã€‚

### 3. é¢„è§ˆæ„å»ºç»“æœï¼ˆå¯é€‰ï¼‰

```bash
npm run preview
```

---

## ğŸš€ éƒ¨ç½²æ–¹å¼

### æ–¹å¼1: Nginx éƒ¨ç½²ï¼ˆæ¨èï¼‰

#### 1. ä¸Šä¼ æ–‡ä»¶

å°† `dist` ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œä¾‹å¦‚ï¼š
```
/var/www/videohub/
```

#### 2. é…ç½® Nginx

åˆ›å»ºæˆ–ç¼–è¾‘ Nginx é…ç½®æ–‡ä»¶ï¼š

```nginx
server {
    listen 80;
    server_name yourdomain.com;
    
    # å‰ç«¯é™æ€æ–‡ä»¶ç›®å½•
    root /var/www/videohub;
    index index.html;
    
    # å¯ç”¨ gzip å‹ç¼©
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css text/xml text/javascript application/x-javascript application/xml+rss application/json;
    
    # å‰ç«¯è·¯ç”±æ”¯æŒï¼ˆSPAï¼‰
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # API ä»£ç†ï¼ˆå¦‚æœå‰åç«¯åœ¨åŒä¸€åŸŸåï¼‰
    location /api {
        proxy_pass http://localhost:8888;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
    
    # è§†é¢‘èµ„æºä»£ç†
    location /local-videos {
        proxy_pass http://localhost:8888;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_buffering off;
    }
    
    # é™æ€èµ„æºç¼“å­˜
    location ~* \.(jpg|jpeg|png|gif|ico|css|js|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

#### 3. é‡å¯ Nginx

```bash
sudo nginx -t  # æµ‹è¯•é…ç½®
sudo systemctl reload nginx  # é‡æ–°åŠ è½½é…ç½®
```

### æ–¹å¼2: Apache éƒ¨ç½²

#### 1. ä¸Šä¼ æ–‡ä»¶

å°† `dist` ç›®å½•ä¸Šä¼ åˆ° Apache ç½‘ç«™æ ¹ç›®å½•ã€‚

#### 2. é…ç½® Apache

åˆ›å»ºæˆ–ç¼–è¾‘ `.htaccess` æ–‡ä»¶ï¼š

```apache
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  RewriteRule ^index\.html$ - [L]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule . /index.html [L]
</IfModule>

# å¯ç”¨ gzip å‹ç¼©
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# ç¼“å­˜é™æ€èµ„æº
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType text/css "access plus 1 year"
  ExpiresByType application/javascript "access plus 1 year"
</IfModule>
```

### æ–¹å¼3: Docker éƒ¨ç½²

#### 1. åˆ›å»º Dockerfile

```dockerfile
# æ„å»ºé˜¶æ®µ
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

# è¿è¡Œé˜¶æ®µ
FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/conf.d/default.conf
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

#### 2. åˆ›å»º nginx.conf

```nginx
server {
    listen 80;
    root /usr/share/nginx/html;
    index index.html;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    location /api {
        proxy_pass http://backend:8888;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

#### 3. æ„å»ºå’Œè¿è¡Œ

```bash
docker build -t videohub-frontend .
docker run -d -p 80:80 videohub-frontend
```

### æ–¹å¼4: é™æ€æ‰˜ç®¡æœåŠ¡

#### Vercel éƒ¨ç½²

1. å®‰è£… Vercel CLIï¼š
```bash
npm i -g vercel
```

2. éƒ¨ç½²ï¼š
```bash
cd frontend/VideoHub_web
vercel
```

#### Netlify éƒ¨ç½²

1. å®‰è£… Netlify CLIï¼š
```bash
npm i -g netlify-cli
```

2. éƒ¨ç½²ï¼š
```bash
cd frontend/VideoHub_web
npm run build
netlify deploy --prod --dir=dist
```

---

## âš™ï¸ ç¯å¢ƒå˜é‡é…ç½®

### å¼€å‘ç¯å¢ƒ

åˆ›å»º `.env.development`:
```env
# ä½¿ç”¨Viteä»£ç†ï¼ˆæ¨èï¼‰
# VITE_API_BASE_URL=

# æˆ–ç›´æ¥è¿æ¥åç«¯
# VITE_API_BASE_URL=http://localhost:8888
```

### ç”Ÿäº§ç¯å¢ƒ

åˆ›å»º `.env.production`:
```env
# åç«¯APIåœ°å€
VITE_API_BASE_URL=https://api.yourdomain.com

# å¦‚æœéƒ¨ç½²åœ¨å­ç›®å½•
# VITE_BASE_URL=/videohub/
```

### ä¿®æ”¹ vite.config.js

ç¡®ä¿é…ç½®æ”¯æŒç¯å¢ƒå˜é‡ï¼š

```javascript
export default defineConfig({
  // ...
  base: process.env.VITE_BASE_URL || (process.env.NODE_ENV === 'production' ? '/videohub/' : '/'),
  // ...
})
```

---

## ğŸ”§ ä¿®æ”¹è¯·æ±‚é…ç½®

å¦‚æœå‰åç«¯ä¸åœ¨åŒä¸€åŸŸåï¼Œéœ€è¦ä¿®æ”¹ `src/utils/request.js`:

```javascript
// ä½¿ç”¨ç¯å¢ƒå˜é‡
const BASE_URL = import.meta.env.VITE_API_BASE_URL || ''

const instance = axios.create({
  baseURL: BASE_URL,
  timeout: 15000
})
```

---

## ğŸ“ éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] Node.js ç‰ˆæœ¬ >= 16.0.0
- [ ] ä¾èµ–å®‰è£…å®Œæˆ (`npm install`)
- [ ] ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®
- [ ] æ„å»ºæˆåŠŸ (`npm run build`)
- [ ] é™æ€æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨
- [ ] WebæœåŠ¡å™¨é…ç½®æ­£ç¡®ï¼ˆNginx/Apacheï¼‰
- [ ] APIä»£ç†é…ç½®æ­£ç¡®
- [ ] åç«¯æœåŠ¡æ­£å¸¸è¿è¡Œ
- [ ] è·¨åŸŸé…ç½®æ­£ç¡®ï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] HTTPSé…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰

---

## â“ å¸¸è§é—®é¢˜

### 1. è·¯ç”±404é”™è¯¯

**é—®é¢˜**: åˆ·æ–°é¡µé¢æˆ–ç›´æ¥è®¿é—®è·¯ç”±æ—¶å‡ºç°404ã€‚

**è§£å†³**: é…ç½®WebæœåŠ¡å™¨æ”¯æŒSPAè·¯ç”±ï¼š
- Nginx: æ·»åŠ  `try_files $uri $uri/ /index.html;`
- Apache: é…ç½® `.htaccess` é‡å†™è§„åˆ™

### 2. APIè¯·æ±‚å¤±è´¥

**é—®é¢˜**: å‰ç«¯æ— æ³•è¿æ¥åˆ°åç«¯APIã€‚

**è§£å†³**:
1. æ£€æŸ¥ `VITE_API_BASE_URL` ç¯å¢ƒå˜é‡
2. æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œ
3. æ£€æŸ¥CORSé…ç½®
4. æ£€æŸ¥Nginxä»£ç†é…ç½®

### 3. é™æ€èµ„æº404

**é—®é¢˜**: å›¾ç‰‡ã€CSSã€JSæ–‡ä»¶åŠ è½½å¤±è´¥ã€‚

**è§£å†³**:
1. æ£€æŸ¥ `vite.config.js` ä¸­çš„ `base` é…ç½®
2. æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥WebæœåŠ¡å™¨é™æ€æ–‡ä»¶é…ç½®

### 4. æ„å»ºæ–‡ä»¶è¿‡å¤§

**é—®é¢˜**: `dist` ç›®å½•æ–‡ä»¶å¾ˆå¤§ã€‚

**è§£å†³**:
1. å¯ç”¨gzipå‹ç¼©
2. ä½¿ç”¨ä»£ç åˆ†å‰²
3. å‹ç¼©å›¾ç‰‡èµ„æº
4. ä½¿ç”¨CDNåŠ è½½ç¬¬ä¸‰æ–¹åº“

### 5. ç¯å¢ƒå˜é‡ä¸ç”Ÿæ•ˆ

**é—®é¢˜**: ç¯å¢ƒå˜é‡åœ¨æ„å»ºåä¸ç”Ÿæ•ˆã€‚

**è§£å†³**:
1. ç¯å¢ƒå˜é‡å¿…é¡»ä»¥ `VITE_` å¼€å¤´
2. ä¿®æ”¹ç¯å¢ƒå˜é‡åéœ€è¦é‡æ–°æ„å»º
3. æ£€æŸ¥ `.env` æ–‡ä»¶ä½ç½®æ˜¯å¦æ­£ç¡®

---

## ğŸ”’ å®‰å…¨å»ºè®®

1. **å¯ç”¨HTTPS**: ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨HTTPS
2. **è®¾ç½®å®‰å…¨å¤´**: åœ¨Nginxä¸­é…ç½®å®‰å…¨å“åº”å¤´
3. **APIå¯†é’¥ä¿æŠ¤**: ä¸è¦åœ¨å‰ç«¯ä»£ç ä¸­ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯
4. **CORSé…ç½®**: æ­£ç¡®é…ç½®è·¨åŸŸèµ„æºå…±äº«
5. **å†…å®¹å®‰å…¨ç­–ç•¥**: é…ç½®CSPé˜²æ­¢XSSæ”»å‡»

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- é¡¹ç›® README.md
- Vite å®˜æ–¹æ–‡æ¡£: https://vitejs.dev/
- Vue å®˜æ–¹æ–‡æ¡£: https://vuejs.org/

